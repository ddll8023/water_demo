# 前端样式规范文档

本项目的 `styles` 目录采用“变量与混入驱动”的样式体系，不提供全局工具类。开发时仅使用 CSS 变量与组件内 `<style scoped>`，按需引用混入（mixins）。尽量复用通用样式变量，除非高度定制化可以创建新变量，如果有新变量需要创建，则需要另外说明。

## 核心原则

### 变量分离原则

- **通用变量**：跨组件共用的基础变量（颜色系统、间距、字体等）统一在 `variables.scss` 中定义。
- **业务专用变量**：特定业务模块的变量（地图、图表、布局组件等）必须在 `business/` 对应模块中定义。
- **严格分离**：禁止在通用变量文件中混入业务专用变量，禁止在组件内定义变量或混入。

### 优先级规则

1. **优先使用**现有通用变量
2. **其次使用**对应业务模块变量
3. **最后考虑**新增业务模块变量（需在对应 business 目录中创建）

## 目录定位

- `frontend/src/assets/styles/variables.scss`：**仅全局通用** CSS 变量（颜色、字体、间距、圆角、阴影、z-index、过渡动画、布局变量、暗色主题变量）。
- `frontend/src/assets/styles/mixins.scss`：全局混入（响应式断点 `respond-to`、布局 `flex-*`、文本省略、按钮/卡片样式、滚动条、状态等）+ 业务专用混入。
- `frontend/src/assets/styles/base/reset.scss`：基础重置，仅元素选择器。
- `frontend/src/assets/styles/base/animations.scss`：仅保留 `@keyframes`（如 `amap-*`）。
- `frontend/src/assets/styles/business/colors/`：业务专用颜色变量（地图设施、监测站、区域、图表监测组件等）。
- `frontend/src/assets/styles/business/layout/`：布局专用变量（侧边栏、面板、菜单等）。
- `frontend/src/assets/styles/business/animations/`：业务专用动画变量（地图标记动画、组件动画等）。

## 引用约定

- 组件内样式统一引入：
  - `@use "@/assets/styles/index.scss" as *;`
- 仅在组件内定义样式规则，禁止新增全局工具类。

## 常见场景与对应文件

### 通用样式变量

- 颜色/主题：在 `variables.scss` 查找 `--primary-color`、`--text-*`、`--bg-*`、`--border-*`，暗色主题在同文件 `[data-theme="dark"]` 下。
- 间距/尺寸：在 `variables.scss` 查找 `--spacing-*`（含 `--spacing-1/3/5/xs/sm`）、`--header-height`、`--sidebar-width`、`--table-row-height` 等。
- 圆角/阴影：在 `variables.scss` 查找 `--border-radius-*`（含 `--border-radius-md/xl/pill`）、`--shadow-*`。
- 字体：在 `variables.scss` 查找 `--font-family-*`、`--font-size-*`、`--font-weight-*`。
- 基础动画：在 `variables.scss` 查找 `--transition-*`；关键帧在 `base/animations.scss`。
- 响应式断点与布局混入：在 `mixins.scss` 使用 `@include respond-to(sm|md|lg|xl)`、`@include flex-center` 等。

### 业务专用变量

- 地图业务颜色：在 `business/colors/map.scss` 查找 `--facility-*`、`--station-*`、`--area-*` 变量。
- 图表监测组件：在 `business/colors/chart.scss` 查找 `--chart-*` 变量（背景渐变、阴影、边框、过渡动画）。
- 侧边栏/菜单样式：在 `business/layout/sidebar.scss` 查找 `--sidebar-*`、`--menu-*` 变量。
- 面板动画：在 `business/layout/panel.scss` 查找 `--panel-*` 变量。
- 地图动画：在 `business/animations/map.scss` 查找 `--marker-*`、`--animation-*` 变量。

### 混入使用

- 通用混入：在 `mixins.scss` 使用 `@include flex-center`、`@include text-ellipsis` 等。
- 图表专用混入：在 `mixins.scss` 使用 `@include chart-info-panel`、`@include chart-empty-state-message` 等。

### 第三方组件

- Element Plus 定制：优先使用变量（如 `--el-*`），在组件内通过 `:deep()` 覆盖子组件样式。

## 实施要点

### 基础原则

- 统一入口：仅通过 `index.scss` 引入变量与混入；不再引入任何工具类文件。
- 组件内样式：遵循 BEM，使用 CSS 变量，不使用 `.m-*`、`.flex*`、`.text-*` 等类名。
- 覆盖第三方样式：使用 `:deep()`，控制范围在组件内部。

### 变量分离原则

- **通用变量**：仅在 `variables.scss` 定义跨组件通用的变量（颜色系统、间距系统、字体系统等）。
- **业务专用变量**：必须在 `business/` 对应模块中定义（地图、图表、布局、动画等）。
- **禁止混入**：通用变量文件中不得包含任何业务专用变量。

### 业务模块扩展

- 扩展业务颜色：在 `business/colors/` 新增模块文件，并在 `business/colors/index.scss` 引入。
- 扩展布局变量：在 `business/layout/` 新增模块文件，创建对应入口文件。
- 扩展动画变量：在 `business/animations/` 新增模块文件，创建对应入口文件。

### 组件开发规范

- **禁止**在组件内定义 SCSS 变量或混入。
- **必须**使用对应业务模块的专用变量。
- **优先**使用现有变量，确需新变量时在对应 business 模块中添加。

## 校验清单

### 基础规范校验

- 不存在 `utils/` 工具类引用或全局类名定义。
- `index.scss` 仅包含 `variables.scss`、`mixins.scss`、`base/reset.scss`、`base/animations.scss`、`business/colors/index.scss`。
- 组件中的样式均通过 CSS 变量与混入实现，无全局类依赖。

### 变量分离校验

- `variables.scss` 中不存在业务专用变量（地图、图表、侧边栏、面板等）。
- 业务专用变量正确分类存放在 `business/` 对应模块中。
- 新增 business 模块已在对应 `index.scss` 中正确引入。

### 组件规范校验

- 组件内不存在 SCSS 变量定义（`$variable-name`）。
- 组件内不存在混入定义（`@mixin mixin-name`）。
- 组件正确使用 business 模块变量（`var(--chart-*)`、`var(--facility-*)` 等）。
- 组件混入调用使用正确前缀（`@include chart-*`、`@include flex-*` 等）。

### 示例参考

- 图表组件：参考 `MonitoringChart.vue` 使用 `business/colors/chart.scss` 变量。
- 地图组件：参考使用 `business/colors/map.scss` 变量。
- 布局组件：参考使用 `business/layout/` 模块变量。
