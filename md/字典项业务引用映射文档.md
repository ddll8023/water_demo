# 字典项业务引用映射文档

## 文档说明

本文档详细记录了水利资源管理系统中各字典类型及其对应字典项在业务模块中的具体引用关系，为字典数据的维护和影响分析提供准确的参考依据。本次分析重点关注工程信息服务相关字典的使用情况，确保文档与实际代码实现保持一致。

## 1. 基础状态类字典引用

### 1.1 用户状态 (user_status)

**字典项**：

- 启用 (1)
- 禁用 (0)

**业务引用**：

- **表**: `users`
  - **字段**: `is_active` (String)
  - **文件**: `demo/src/main/java/com/example/demo/entity/system/User.java`
  - **引用方式**: 后端直接存储编码值 ('1' 或 '0')，前端通过字典 API 获取显示文本
- **前端使用**：
  - `frontend/src/views/system/UserManagement.vue`（通过字典 API 显示状态和表单选项）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.USER_STATUS` 常量，注：实际仅包含基础状态类常量）

### 1.2 设备状态 (device_status)

**字典项**：

- 正常 (normal)
- 故障 (fault)
- 维护 (maintenance)

**业务引用**：

- **表**: `floating_boats`
  - **字段**: `pumping_status` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/FloatingBoat.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/FloatingBoatMapper.xml` (生成 `pumping_status_name`)
- **表**: `inspection_records`
  - **字段**: `device_status` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/inspection/InspectionRecord.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/InspectionRecordMapper.xml` (生成 `device_status_name`)
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`（浮船状态显示和选择）
  - `frontend/src/views/inspection/InspectionManagement.vue`（设备状态字典加载）
  - `frontend/src/components/Inspection/InspectionRecords.vue`（设备状态显示和表单选项）
  - `frontend/src/views/map/MapOverview.vue`（地图设备信息弹窗中显示状态，设备状态筛选）
  - `frontend/src/components/Map/AMapContainer.vue`（地图容器设备状态显示和筛选）
  - `frontend/src/utils/map/deviceType.js`（地图工具类静态配置，包含设备状态映射）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.DEVICE_STATUS` 常量）

### 1.3 部门状态 (department_status)

**字典项**：

- 启用 (1)
- 禁用 (0)

**业务引用**：

- **表**: `departments`
  - **字段**: `is_active` (String)
  - **文件**: `demo/src/main/java/com/example/demo/entity/system/Department.java`
  - **引用方式**: 后端直接存储编码值 ('1' 或 '0')，前端通过字典 API 获取显示文本
- **前端使用**：
  - `frontend/src/views/system/DepartmentManagement.vue`（通过字典 API 显示状态和表单选项）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.DEPARTMENT_STATUS` 常量）

## 2. 工程信息服务字典引用

### 2.1 运行方式 (operation_mode)

**字典项**：

- 1 用 1 备 (1_main_1_backup)
- 2 用 1 备 (2_main_1_backup)
- 单机运行 (single_operation)
- 并联运行 (parallel_operation)

**业务引用**：

- **表**: `pumping_stations`
  - **字段**: `operation_mode` (VARCHAR(100))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/PumpingStation.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/PumpingStationMapper.xml` (生成 `operation_mode_name`)
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`

### 2.2 工程等级 (engineering_grade)

**字典项**：

- Ⅰ 等 (grade_1)
- Ⅱ 等 (grade_2)
- Ⅲ 等 (grade_3)
- Ⅳ 等 (grade_4)
- Ⅴ 等 (grade_5)
- V (V)

**业务引用**：

- **表**: `reservoirs`
  - **字段**: `engineering_grade` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/Reservoir.java`
  - **引用方式**: 关联 dict_data.data_value
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`

### 2.3 工程规模 (engineering_scale)

**字典项**：

- 大型 (large)
- 中型 (medium)
- 小型 (small)
- 小(1)型 (small_1)

**业务引用**：

- **表**: `reservoirs`
  - **字段**: `engineering_scale` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/Reservoir.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/ReservoirMapper.xml` (生成 `engineering_scale_name`)
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`（水库表格列显示和字典类型配置）

### 2.4 管道类型 (pipeline_type)

**字典项**：

- 供水干管 (main_pipeline)
- 供水支管 (branch_pipeline)
- 输水管道 (transmission_pipeline)
- 配水管道 (distribution_pipeline)

**业务引用**：

- **表**: `pipelines`
  - **字段**: `pipeline_type` (VARCHAR(100))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/Pipeline.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/PipelineMapper.xml` (生成 `pipeline_type_name`)
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`

## 3. 监测数据字典引用

### 3.1 监测项目 (monitoring_item)

**字典项**：

- 流量监测 (Q)
- 视频监控 (V)
- 水位监测 (H)
- 水质监测 (WQ)
- 水温监测 (WT)
- 浊度监测 (TU)
- PH 监测 (PH)
- 电导率监测 (EC)
- 溶解氧监测 (DO)
- 氨氮监测 (AN)
- 化学需氧量监测 (COD)
- 余氯监测 (RC)
- 雨情监测 (R)

**业务引用**：

- **表**: `monitoring_stations`
  - **字段**: `monitoring_item_code` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/facility/MonitoringStation.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/MonitoringStationMapper.xml` (生成 `monitoring_item_name`)
- **表**: `warning_thresholds`
  - **字段**: `monitoring_item` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/warning/WarningThreshold.java`
  - **引用方式**: 关联 dict_data.data_value
- **前端使用**:
  - `frontend/src/views/engineering/EngineeringService.vue`（通过字典 API）
  - `frontend/src/components/Warning/ThresholdsManagement.vue`（通过字典 API）
  - `frontend/src/components/Map/AMapContainer.vue`（使用内置配置 MONITORING_ITEM_CONFIG，已与字典数据同步）
  - `frontend/src/components/Map/DeviceInfoPopup.vue`（使用内置配置 MONITORING_ITEM_CONFIG，已与字典数据同步）
  - `frontend/src/utils/map/deviceIcon.js`（定义内置配置 MONITORING_ITEM_CONFIG，包含完整的 13 种监测项目）

### 3.2 数据质量 (data_quality)

**字典项**：

- 正常 (1)
- 异常 (2)
- 缺失 (3)

**业务引用**：

- **表**: `flow_monitoring_data`
  - **字段**: `data_quality` (TINYINT)
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/FlowMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/FlowMonitoringDataMapper.xml` (生成 `data_quality_text`)
- **表**: `water_quality_monitoring_data`
  - **字段**: `data_quality` (TINYINT)
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/WaterQualityMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterQualityMonitoringDataMapper.xml` (生成 `data_quality_text`)
- **表**: `reservoir_monitoring_data`
  - **字段**: `data_quality` (TINYINT)
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/ReservoirMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterConditionMonitoringDataMapper.xml` (生成 `data_quality_text`)
- **表**: `rainfall_monitoring_data`
  - **字段**: `data_quality` (TINYINT)
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/RainfallMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/RainfallMonitoringDataMapper.xml` (生成 `data_quality_text`)
- **表**: `water_level_monitoring_data`
  - **字段**: `data_quality` (TINYINT)
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/WaterLevelMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterLevelMonitoringDataMapper.xml` (生成 `data_quality_text`)
- **前端使用**：
  - `frontend/src/views/monitoring/FlowMonitoring.vue`（表格显示数据质量字段）
  - `frontend/src/views/monitoring/WaterQualityMonitoring.vue`（表格显示数据质量字段）

### 3.3 采集方式 (collection_method)

**字典项**：

- 自动采集 (AUTO)
- 手动录入 (MANUAL)

**业务引用**：

- **表**: `flow_monitoring_data`
  - **字段**: `collection_method` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/FlowMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/FlowMonitoringDataMapper.xml` (生成 `collection_method_text`)
- **表**: `water_quality_monitoring_data`
  - **字段**: `collection_method` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/WaterQualityMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterQualityMonitoringDataMapper.xml` (生成 `collection_method_text`)
- **表**: `reservoir_monitoring_data`
  - **字段**: `collection_method` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/ReservoirMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterConditionMonitoringDataMapper.xml` (生成 `collection_method_text`)
- **表**: `rainfall_monitoring_data`
  - **字段**: `collection_method` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/RainfallMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/RainfallMonitoringDataMapper.xml` (生成 `collection_method_text`)
- **表**: `water_level_monitoring_data`
  - **字段**: `collection_method` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/monitoring/WaterLevelMonitoringData.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/WaterLevelMonitoringDataMapper.xml` (生成 `collection_method_text`)
- **前端使用**：
  - `frontend/src/views/monitoring/FlowMonitoring.vue`（表格显示采集方式字段）
  - `frontend/src/views/monitoring/WaterQualityMonitoring.vue`（表格显示采集方式字段）

## 4. 巡检管理字典引用

### 4.1 巡检状态 (inspection_status)

**字典项**：

- 未开始 (PENDING)
- 进行中 (IN_PROGRESS)
- 已完成 (COMPLETED)
- 异常 (EXCEPTION)

**业务引用**：

- **表**: `inspection_tasks`
  - **字段**: `status` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/inspection/InspectionTask.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/InspectionTaskMapper.xml` (生成 `status_text`)
- **前端使用**:
  - `frontend/src/views/inspection/InspectionManagement.vue`（字典数据加载）
  - `frontend/src/components/Inspection/InspectionTasks.vue`（状态显示和状态更改确认）

### 4.2 巡检频次 (inspection_frequency)

**字典项**：

- 日 (daily)
- 周 (weekly)
- 月 (monthly)
- 季 (quarterly)
- 应急 (emergency)

**业务引用**：

- **表**: `inspection_tasks`
  - **字段**: `frequency` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/inspection/InspectionTask.java`
  - **引用方式**: 通过字典表关联查询 (LEFT JOIN dict_data)
  - **Mapper**: `demo/src/main/resources/mapper/InspectionTaskMapper.xml` (生成 `frequency_text`)
- **前端使用**:
  - `frontend/src/views/inspection/InspectionManagement.vue`（字典数据加载）
  - `frontend/src/components/Inspection/InspectionTasks.vue`（频次选择和表单选项）

## 5. 预警管理字典引用

### 5.1 预警级别 (warning_level)

**字典项**：

- 一级预警 (1)
- 二级预警 (2)
- 三级预警 (3)
- 四级预警 (4)

**业务引用**：

- **表**: `warning_records`
  - **字段**: `warning_level` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/warning/WarningRecord.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/WarningRecordMapper.xml` (生成 `warning_level_name`)
- **前端使用**:
  - `frontend/src/components/Warning/RecordsManagement.vue`（预警记录表单选项和搜索条件）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.WARNING_LEVEL` 常量）

### 5.2 预警类型 (warning_type)

**字典项**：

- 水位预警 (水位)
- 流量预警 (流量)
- 水质预警 (水质)
- 设备预警 (设备)
- 水温预警 (水温)
- 雨情预警 (雨情)

**业务引用**：

- **表**: `warning_records`
  - **字段**: `warning_type` (VARCHAR(100))
  - **文件**: `demo/src/main/java/com/example/demo/entity/warning/WarningRecord.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/WarningRecordMapper.xml` (生成 `warning_type_name`)
- **前端使用**:
  - `frontend/src/components/Warning/RecordsManagement.vue`（预警记录表单选项和搜索条件）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.WARNING_TYPE` 常量）

### 5.3 预警状态 (warning_status)

**字典项**：

- 进行中 (进行中)
- 已解除 (已解除)

**业务引用**：

- **表**: `warning_records`
  - **字段**: `warning_status` (VARCHAR(50))
  - **文件**: `demo/src/main/java/com/example/demo/entity/warning/WarningRecord.java`
  - **引用方式**: 关联 dict_data.data_value
  - **Mapper**: `demo/src/main/resources/mapper/WarningRecordMapper.xml` (生成 `warning_status_name`)
- **前端使用**:
  - `frontend/src/components/Warning/RecordsManagement.vue`（搜索条件和状态显示）
  - `frontend/src/views/warning/WarningManagement.vue`（预警管理主页）
  - `frontend/src/composables/useDictionary.js`（定义 `DICT_TYPES.WARNING_STATUS` 常量）

## 6. 补充说明

### 6.1 字典使用方式说明

- **字典 API 与静态配置的混合使用**：部分字典存在两种使用方式
  - **设备状态字典**：
    - **字典 API**：系统管理、工程服务、巡检管理模块通过 `getDictData('device_status')` 获取实时数据
    - **静态配置**：地图工具类使用 `getDeviceStatusClass` 和 `getDeviceStatusText` 函数进行状态映射，已优化并与字典数据保持一致
  - **监测项目字典**：
    - **字典 API**：工程服务和预警管理模块通过 `getDictData('monitoring_item')` 获取实时数据
    - **静态配置**：地图组件使用 `MONITORING_ITEM_CONFIG` 静态配置，已与字典数据完全同步，包含完整的 13 种监测项目
    - **地图概览查询**：`demo/src/main/resources/mapper/MapOverviewMapper.xml` 通过字典表关联查询获取监测项目名称
  - **静态配置文件**：
    - `frontend/src/utils/map/deviceIcon.js`：定义 `FACILITY_TYPE_CONFIG` 和 `MONITORING_ITEM_CONFIG` 静态配置，已与字典数据同步，包含完整的 13 种监测项目配置
    - `frontend/src/utils/map/deviceType.js`：提供设备状态映射函数，已优化映射逻辑确保与字典数据一致
    - `frontend/src/components/Map/AMapContainer.vue`：使用 `FACILITY_TYPE_CONFIG` 静态配置以提升地图渲染性能
    - `frontend/src/components/Map/DeviceInfoPopup.vue`：使用内置 `facilityTypeMap` 和 `monitoringTypeMap` 进行类型映射
    - `frontend/src/components/Map/FacilityPanel.vue`：使用 `DEVICE_TYPE_OPTIONS` 配置设备类型筛选选项
    - `frontend/src/assets/styles/business/colors/map.scss`：定义水质细分监测项目的颜色变量
    - `frontend/src/assets/styles/business/icons/map.scss`：定义水质细分监测项目的图标符号变量
  - **维护要求**：静态配置已与字典数据保持同步，后端 Mapper 查询已消除硬编码
  - **一致性验证**：经过代码分析，所有监测数据模块（流量、水质、水位、降雨、水情）的字典关联查询均已正确实现，包含完整的字典类型条件和数据质量检查

### 6.2 后端字典关联说明

- **有字典关联查询的模块**：
  - 浮船信息：生成 `pumping_status_name`
  - 泵站信息：生成 `operation_mode_name`
  - 管道信息：生成 `pipeline_type_name`
  - 水库信息：生成 `engineering_grade_name` 和 `engineering_scale_name`
  - 监测站点：生成 `monitoring_item_name`
  - 预警指标：生成 `monitoring_item_name`（关联监测项目字典）
  - 预警记录：生成 `warning_level_name`、`warning_type_name` 和 `warning_status_name`
  - 巡检记录：生成 `device_status_name`
  - 巡检任务：生成 `status_text` 和 `frequency_text`
  - 监测数据模块：所有监测数据 Mapper 已实现字典关联查询，生成 `data_quality_text` 和 `collection_method_text`
  - 水情监测数据：生成 `data_quality_text` 和 `collection_method_text`
  - 地图概览：通过字典表关联查询生成 `monitoring_item_name`
- **无字典关联查询的模块**：
  - 用户管理：直接存储编码值，前端通过字典 API 获取显示文本
  - 部门管理：直接存储编码值，前端通过字典 API 获取显示文本

### 6.3 数据完整性

- 字典数据的完整性：各字典类型已包含必要的项目，能够满足系统各模块的业务需求。
